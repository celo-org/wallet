diff --git a/node_modules/bn.js/lib/bn.js b/node_modules/bn.js/lib/bn.js
index c9773da..bfad934 100644
--- a/node_modules/bn.js/lib/bn.js
+++ b/node_modules/bn.js/lib/bn.js
@@ -48,15 +48,18 @@
   BN.BN = BN;
   BN.wordSize = 26;
 
-  var Buffer;
-  try {
-    if (typeof window !== 'undefined' && typeof window.Buffer !== 'undefined') {
+  if (!Buffer) {
+    var Buffer;
+    if (global && global.Buffer) {
+      Buffer = global.Buffer
+    } else if (window && window.Buffer) {
       Buffer = window.Buffer;
     } else {
-      Buffer = require('buffer').Buffer;
+      try {
+        Buffer = require("buffer").Buffer;
+      } catch (e) {}
     }
-  } catch (e) {
-  }
+  }    
 
   BN.isBN = function isBN (num) {
     if (num instanceof BN) {
